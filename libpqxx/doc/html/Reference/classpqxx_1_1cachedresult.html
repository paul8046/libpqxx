<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>libpqxx: pqxx::cachedresult class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.1 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>pqxx::cachedresult Class Reference</h1><code>#include &lt;<a class="el" href="cachedresult_8h-source.html">cachedresult.h</a>&gt;</code>
<p>
<a href="classpqxx_1_1cachedresult-members.html">List of all members.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Public Types</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="classpqxx_1_1result.html#w0">result::size_type</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classpqxx_1_1cachedresult.html#w0">size_type</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="classpqxx_1_1cachedresult.html#w0">size_type</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classpqxx_1_1cachedresult.html#w1">blocknum</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="classpqxx_1_1result_1_1tuple.html">result::tuple</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classpqxx_1_1cachedresult.html#w2">tuple</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Tuple type. Currently borrowed from result, but may change in the future.</em> <a href="#w2"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>typedef <a class="el" href="classpqxx_1_1cachedresult.html#w2">tuple</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classpqxx_1_1cachedresult.html#w3">Tuple</a></td></tr>

<tr><td colspan=2><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>template&lt;typename TRANSACTION&gt; &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classpqxx_1_1cachedresult.html#a0">cachedresult</a> (TRANSACTION &amp;T, const char Query[], const PGSTD::string &amp;BaseName="query", <a class="el" href="classpqxx_1_1cachedresult.html#w0">size_type</a> Granularity=100)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>const <a class="el" href="classpqxx_1_1cachedresult.html#w2">tuple</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classpqxx_1_1cachedresult.html#a1">operator[]</a> (<a class="el" href="classpqxx_1_1cachedresult.html#w0">size_type</a> i) const</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Access a tuple. Invalid index yields undefined behaviour.</em> <a href="#a1"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>const <a class="el" href="classpqxx_1_1cachedresult.html#w2">tuple</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classpqxx_1_1cachedresult.html#a2">at</a> (<a class="el" href="classpqxx_1_1cachedresult.html#w0">size_type</a> i) const</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Access a tuple. Throws exception if index is out of range.</em> <a href="#a2"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="classpqxx_1_1cachedresult.html#w0">size_type</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classpqxx_1_1cachedresult.html#a3">size</a> () const</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Number of rows in result set. First call may be slow.</em> <a href="#a3"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>bool&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classpqxx_1_1cachedresult.html#a4">empty</a> () const</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Is the result set empty, i.e. does it contain no rows? May fetch 1 block.</em> <a href="#a4"></a><em><br><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Cached result set. Chunks of result data are transparently fetched on-demand and stored in an internal cache for reuse. Functionality is similar to that of result, with certain restrictions and different performance characteristics. A cachedresult must live in the context of a backend transaction, so that it can fetch further rows as they are needed. Furthermore, the transaction must have serializable isolation level to ensure that the result set of the query remains unchanged while parts of it are cached.<p>
The class uses a <a class="el" href="classpqxx_1_1Cursor.html">Cursor</a> internally to fetch results. Data are not fetched row-by-row, but in chunks of configurable size. For internal computational reasons, these chunks (called "blocks" here) must be at least 2 rows large.<p>
CAUTION: PostgreSQL currently doesn't always let you move cursors backwards, which is a feature this class relies upon. As a result, cachedresult will only work on certain types of queries. To make things worse, there is no documentation to define exactly which queries those are. Therefore the only way to use cachedresult at this time is to test carefully. Hopefully this can be fixed in the future. 
<p>
<hr><h2>Member Typedef Documentation</h2>
<a name="w1" doxytag="pqxx::cachedresult::blocknum"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef <a class="el" href="classpqxx_1_1cachedresult.html#w0">size_type</a> <a class="el" href="classpqxx_1_1cachedresult.html#w1">pqxx::cachedresult::blocknum</a>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a name="w0" doxytag="pqxx::cachedresult::size_type"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef <a class="el" href="classpqxx_1_1result.html#w0">result::size_type</a> <a class="el" href="classpqxx_1_1cachedresult.html#w0">pqxx::cachedresult::size_type</a>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
    </td>
  </tr>
</table>
<a name="w3" doxytag="pqxx::cachedresult::Tuple"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef <a class="el" href="classpqxx_1_1cachedresult.html#w2">tuple</a> <a class="el" href="classpqxx_1_1cachedresult.html#w3">pqxx::cachedresult::Tuple</a>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b><a class="el" href="deprecated.html#_deprecated000002">Deprecated:</a></b></dt><dd>For compatibility with old Tuple class</dd></dl>
    </td>
  </tr>
</table>
<a name="w2" doxytag="pqxx::cachedresult::tuple"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> typedef <a class="el" href="classpqxx_1_1result_1_1tuple.html">result::tuple</a> <a class="el" href="classpqxx_1_1cachedresult.html#w2">pqxx::cachedresult::tuple</a>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Tuple type. Currently borrowed from result, but may change in the future.
<p>
    </td>
  </tr>
</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a name="a0" doxytag="pqxx::cachedresult::cachedresult"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" colspan="4">
template&lt;typename TRANSACTION&gt; </td>
        </tr>
        <tr>
          <td class="md" nowrap valign="top"> pqxx::cachedresult::cachedresult </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">TRANSACTION &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>T</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const char&nbsp;</td>
          <td class="mdname" nowrap> <em>Query</em>[], </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const PGSTD::string &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>BaseName</em> = "query", </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap><a class="el" href="classpqxx_1_1cachedresult.html#w0">size_type</a>&nbsp;</td>
          <td class="mdname" nowrap> <em>Granularity</em> = 100</td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [explicit]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Perform query and transparently fetch and cache resulting data. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>T</em>&nbsp;</td><td>is the transaction context in which the cachedresult lives. This will be used whenever data is fetched. Must have isolation level "serializable," otherwise a link error will be generated for the symbol error_permissible_isolation_level. </td></tr>
    <tr><td valign=top><em>Query</em>&nbsp;</td><td>is the SQL query that yields the desired result set. </td></tr>
    <tr><td valign=top><em>BaseName</em>&nbsp;</td><td>gives the initial part of the name for this cachedresult and the <a class="el" href="classpqxx_1_1Cursor.html">Cursor</a> it uses to obtain its results. </td></tr>
    <tr><td valign=top><em>Granularity</em>&nbsp;</td><td>determines how large the blocks of data used internally will be; must be at least 2. </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a name="a2" doxytag="pqxx::cachedresult::at"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> const <a class="el" href="classpqxx_1_1cachedresult.html#w2">tuple</a> pqxx::cachedresult::at </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classpqxx_1_1cachedresult.html#w0">size_type</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>i</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const</td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Access a tuple. Throws exception if index is out of range.
<p>
If the given index is not the index of an existing row, an out_of_range error will be thrown.<p>
Caveat: the tuple contains a reference to a result that may be destroyed by any other operation on the cachedresult, even if its constness is preserved. Therefore only use the returned tuple as a temporary, and do not try to copy-construct it, or keep references or pointers to it.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>i</em>&nbsp;</td><td>the number of the tuple to be accessed. </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a name="a4" doxytag="pqxx::cachedresult::empty"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> bool pqxx::cachedresult::empty </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const</td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Is the result set empty, i.e. does it contain no rows? May fetch 1 block.
<p>
    </td>
  </tr>
</table>
<a name="a1" doxytag="pqxx::cachedresult::operator[]"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> const <a class="el" href="classpqxx_1_1cachedresult.html#w2">tuple</a> pqxx::cachedresult::operator[] </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="classpqxx_1_1cachedresult.html#w0">size_type</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>i</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const</td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Access a tuple. Invalid index yields undefined behaviour.
<p>
Caveat: the tuple contains a reference to a result that may be destroyed by any other operation on the cachedresult, even if its constness is preserved. Therefore only use the returned tuple as a temporary, and do not try to copy-construct it, or keep references or pointers to it.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>i</em>&nbsp;</td><td>the number of the tuple to be accessed. </td></tr>
  </table>
</dl>
    </td>
  </tr>
</table>
<a name="a3" doxytag="pqxx::cachedresult::size"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="classpqxx_1_1cachedresult.html#w0">pqxx::cachedresult::size_type</a> pqxx::cachedresult::size </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const</td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Number of rows in result set. First call may be slow.
<p>
    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="cachedresult_8h-source.html">cachedresult.h</a><li><a class="el" href="cachedresult_8cxx.html">cachedresult.cxx</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Sat Jun 14 00:10:14 2003 for libpqxx by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.1 </small></address>
</body>
</html>
