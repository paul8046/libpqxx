<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>libpqxx: largeobject.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.1 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="hierarchy.html">Class Hierarchy</a> &nbsp; <a class="qindex" href="classes.html">Alphabetical List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; <a class="qindex" href="pages.html">Related Pages</a> &nbsp; </center>
<hr><h1>largeobject.h</h1><a href="largeobject_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/*-------------------------------------------------------------------------</span>
00002 <span class="comment"> *</span>
00003 <span class="comment"> *   FILE</span>
00004 <span class="comment"> *      pqxx/largeobject.h</span>
00005 <span class="comment"> *</span>
00006 <span class="comment"> *   DESCRIPTION</span>
00007 <span class="comment"> *      libpqxx's Large Objects interface</span>
00008 <span class="comment"> *   Allows access to large objects directly, or through I/O streams</span>
00009 <span class="comment"> *</span>
00010 <span class="comment"> * Copyright (c) 2003, Jeroen T. Vermeulen &lt;jtv@xs4all.nl&gt;</span>
00011 <span class="comment"> *</span>
00012 <span class="comment"> * See COPYING for copyright license.  If you did not receive a file called</span>
00013 <span class="comment"> * COPYING with this source code, please notify the distributor of this mistake,</span>
00014 <span class="comment"> * or contact the author.</span>
00015 <span class="comment"> *</span>
00016 <span class="comment"> *-------------------------------------------------------------------------</span>
00017 <span class="comment"> */</span>
00018 <span class="preprocessor">#ifndef PQXX_LARGEOBJECT_H</span>
00019 <span class="preprocessor"></span><span class="preprocessor">#define PQXX_LARGEOBJECT_H</span>
00020 <span class="preprocessor"></span>
00021 <span class="preprocessor">#include "<a class="code" href="config_8h.html">pqxx/config.h</a>"</span>
00022 
00023 <span class="preprocessor">#ifdef HAVE_STREAMBUF</span>
00024 <span class="preprocessor"></span><span class="preprocessor">#include &lt;streambuf&gt;</span>
00025 <span class="preprocessor">#else</span>
00026 <span class="preprocessor"></span><span class="preprocessor">#include &lt;streambuf.h&gt;</span>
00027 <span class="preprocessor">#endif</span>
00028 <span class="preprocessor"></span>
00029 <span class="preprocessor">#include "<a class="code" href="dbtransaction_8h.html">pqxx/dbtransaction.h</a>"</span>
00030 
00031 
00032 <span class="keyword">namespace </span>pqxx
00033 {
00034 
00035 <span class="keyword">class </span>largeobjectaccess;
00036 
00038 
<a name="l00045"></a><a class="code" href="classpqxx_1_1largeobject.html">00045</a> <span class="keyword">class </span>PQXX_LIBEXPORT largeobject
00046 {
00047 <span class="keyword">public</span>:
<a name="l00048"></a><a class="code" href="classpqxx_1_1largeobject.html#w0">00048</a>   <span class="keyword">typedef</span> <span class="keywordtype">long</span> size_type;
00049 
00051   largeobject();                                                        <span class="comment">//[t48]</span>
00052 
00054 
00056   <span class="keyword">explicit</span> largeobject(<a class="code" href="classpqxx_1_1dbtransaction.html">dbtransaction</a> &amp;T);                               <span class="comment">//[t48]</span>
00057 
00059 
<a name="l00063"></a><a class="code" href="classpqxx_1_1largeobject.html#a2">00063</a>   <span class="keyword">explicit</span> largeobject(oid O) : m_ID(O) {}                              <span class="comment">//[t48]</span>
00064 
00066 
00070   largeobject(dbtransaction &amp;T, <span class="keyword">const</span> PGSTD::string &amp;File);             <span class="comment">//[t53]</span>
00071 
00073 
00077   largeobject(<span class="keyword">const</span> largeobjectaccess &amp;O);                              <span class="comment">//[t50]</span>
00078 
00080 
<a name="l00084"></a><a class="code" href="classpqxx_1_1largeobject.html#a5">00084</a>   <a class="code" href="namespacepqxx.html#a24">oid</a> id() <span class="keyword">const</span> <span class="keywordflow">throw</span> () { <span class="keywordflow">return</span> m_ID; }                              <span class="comment">//[t48]</span>
00085 
<a name="l00087"></a><a class="code" href="classpqxx_1_1largeobject.html#a6">00087</a>   <span class="keywordtype">bool</span> operator==(<span class="keyword">const</span> largeobject &amp;other) <span class="keyword">const</span>                       <span class="comment">//[t51]</span>
00088           { <span class="keywordflow">return</span> m_ID == other.m_ID; }
<a name="l00090"></a><a class="code" href="classpqxx_1_1largeobject.html#a7">00090</a>   <span class="keywordtype">bool</span> operator!=(<span class="keyword">const</span> largeobject &amp;other) <span class="keyword">const</span>                       <span class="comment">//[t51]</span>
00091           { <span class="keywordflow">return</span> m_ID != other.m_ID; }
<a name="l00093"></a><a class="code" href="classpqxx_1_1largeobject.html#a8">00093</a>   <span class="keywordtype">bool</span> operator&lt;=(<span class="keyword">const</span> largeobject &amp;other) <span class="keyword">const</span>                       <span class="comment">//[t51]</span>
00094           { <span class="keywordflow">return</span> m_ID &lt;= other.m_ID; }
<a name="l00096"></a><a class="code" href="classpqxx_1_1largeobject.html#a9">00096</a>   <span class="keywordtype">bool</span> operator&gt;=(<span class="keyword">const</span> largeobject &amp;other) <span class="keyword">const</span>                       <span class="comment">//[t51]</span>
00097           { <span class="keywordflow">return</span> m_ID &gt;= other.m_ID; }
<a name="l00099"></a><a class="code" href="classpqxx_1_1largeobject.html#a10">00099</a>   <span class="keywordtype">bool</span> operator&lt;(<span class="keyword">const</span> largeobject &amp;other) <span class="keyword">const</span>                        <span class="comment">//[t51]</span>
00100           { <span class="keywordflow">return</span> m_ID &lt; other.m_ID; }
<a name="l00102"></a><a class="code" href="classpqxx_1_1largeobject.html#a11">00102</a>   <span class="keywordtype">bool</span> operator&gt;(<span class="keyword">const</span> largeobject &amp;other) <span class="keyword">const</span>                        <span class="comment">//[t51]</span>
00103           { <span class="keywordflow">return</span> m_ID &gt; other.m_ID; }
00104 
00106 
00110   <span class="keywordtype">void</span> to_file(dbtransaction &amp;T, <span class="keyword">const</span> PGSTD::string &amp;File) <span class="keyword">const</span>;      <span class="comment">//[t52]</span>
00111 
00113 
00117   <span class="keywordtype">void</span> remove(dbtransaction &amp;T) <span class="keyword">const</span>;                                  <span class="comment">//[t48]</span>
00118 
00119 <span class="keyword">protected</span>:
<a name="l00120"></a><a class="code" href="classpqxx_1_1largeobject.html#f0">00120</a>   <span class="keyword">static</span> PGconn *RawConnection(<span class="keyword">const</span> <a class="code" href="classpqxx_1_1dbtransaction.html">dbtransaction</a> &amp;T)
00121   {
00122     <span class="keywordflow">return</span> T.<a class="code" href="classpqxx_1_1transaction__base.html#a8">Conn</a>().<a class="code" href="classpqxx_1_1connection__base.html#d18">RawConnection</a>();
00123   }
00124 
00125   PGSTD::string Reason() <span class="keyword">const</span>;
00126 
00127 <span class="keyword">private</span>:
00128   <a class="code" href="namespacepqxx.html#a24">oid</a> m_ID;
00129 };
00130 
<a name="l00132"></a><a class="code" href="namespacepqxx.html#a6">00132</a> <span class="keyword">typedef</span> largeobject <a class="code" href="classpqxx_1_1largeobject.html">LargeObject</a>;
00133 
00134 <span class="comment">// TODO: New hierarchy with separate read / write / mixed-mode access</span>
00135 
<a name="l00137"></a><a class="code" href="classpqxx_1_1largeobjectaccess.html">00137</a> <span class="keyword">class </span>PQXX_LIBEXPORT largeobjectaccess : <span class="keyword">private</span> largeobject
00138 {
00139 <span class="keyword">public</span>:
00140   <span class="keyword">using</span> largeobject::size_type;
<a name="l00141"></a><a class="code" href="classpqxx_1_1largeobjectaccess.html#w0">00141</a>   <span class="keyword">typedef</span> <span class="keywordtype">long</span> off_type;
<a name="l00142"></a><a class="code" href="classpqxx_1_1largeobjectaccess.html#w1">00142</a>   <span class="keyword">typedef</span> size_type pos_type;
00143 
00145 
<a name="l00149"></a><a class="code" href="classpqxx_1_1largeobjectaccess.html#w2">00149</a>   <span class="keyword">typedef</span> PGSTD::ios::openmode openmode;
00150 
00152 
<a name="l00156"></a><a class="code" href="classpqxx_1_1largeobjectaccess.html#w3">00156</a>   <span class="keyword">typedef</span> PGSTD::ios::seekdir seekdir;
00157 
00159 
00163   <span class="keyword">explicit</span> largeobjectaccess(<a class="code" href="classpqxx_1_1dbtransaction.html">dbtransaction</a> &amp;T, 
00164                              openmode mode = 
00165                                 PGSTD::ios::in | 
00166                                 PGSTD::ios::out);                       <span class="comment">//[t51]</span>
00167 
00169 
00175   largeobjectaccess(<a class="code" href="classpqxx_1_1dbtransaction.html">dbtransaction</a> &amp;T, 
00176                     oid O,
00177                     openmode mode = 
00178                         PGSTD::ios::in | 
00179                         PGSTD::ios::out);                               <span class="comment">//[t52]</span>
00180 
00182 
00187   largeobjectaccess(<a class="code" href="classpqxx_1_1dbtransaction.html">dbtransaction</a> &amp;T, 
00188                     largeobject O,
00189                     openmode mode = PGSTD::ios::in | PGSTD::ios::out);  <span class="comment">//[t50]</span>
00190 
00192 
00197   largeobjectaccess(<a class="code" href="classpqxx_1_1dbtransaction.html">dbtransaction</a> &amp;T, 
00198                     <span class="keyword">const</span> PGSTD::string &amp;File,
00199                     openmode mode = 
00200                         PGSTD::ios::in | PGSTD::ios::out);              <span class="comment">//[t55]</span>
00201 
<a name="l00202"></a><a class="code" href="classpqxx_1_1largeobjectaccess.html#a4">00202</a>   ~largeobjectaccess() { close(); }
00203 
00205 
00208   <span class="keyword">using</span> largeobject::id;
00209 
00211 
<a name="l00214"></a><a class="code" href="classpqxx_1_1largeobjectaccess.html#a5">00214</a>   <span class="keywordtype">void</span> to_file(<span class="keyword">const</span> PGSTD::string &amp;File) <span class="keyword">const</span>                         <span class="comment">//[t54]</span>
00215   { 
00216     largeobject::to_file(m_Trans, File); 
00217   }
00218 
00220 
00224   <span class="keywordtype">void</span> write(<span class="keyword">const</span> <span class="keywordtype">char</span> Buf[], size_type Len);                          <span class="comment">//[t51]</span>
00225 
00227 
<a name="l00230"></a><a class="code" href="classpqxx_1_1largeobjectaccess.html#a7">00230</a>   <span class="keywordtype">void</span> write(<span class="keyword">const</span> PGSTD::string &amp;Buf)                                  <span class="comment">//[t50]</span>
00231         { write(Buf.c_str(), Buf.size()); }
00232 
00234 
00240   size_type read(<span class="keywordtype">char</span> Buf[], size_type Len);                            <span class="comment">//[t50]</span>
00241 
00243 
00246   size_type seek(size_type dest, seekdir dir);                          <span class="comment">//[t51]</span>
00247 
00249 
00257   pos_type cseek(off_type dest, seekdir dir) <span class="keywordflow">throw</span> ();                  <span class="comment">//[t50]</span>
00258     
00260 
00266   off_type cwrite(<span class="keyword">const</span> <span class="keywordtype">char</span> Buf[], size_type Len) <span class="keywordflow">throw</span> ();            <span class="comment">//[t50]</span>
00267 
00269 
00275   off_type cread(<span class="keywordtype">char</span> Buf[], size_type Len) <span class="keywordflow">throw</span> ();                   <span class="comment">//[t50]</span>
00276 
00277   <span class="keyword">using</span> largeobject::operator==;
00278   <span class="keyword">using</span> largeobject::operator!=;
00279   <span class="keyword">using</span> largeobject::operator&lt;;
00280   <span class="keyword">using</span> largeobject::operator&lt;=;
00281   <span class="keyword">using</span> largeobject::operator&gt;;
00282   <span class="keyword">using</span> largeobject::operator&gt;=;
00283 
00284 <span class="keyword">private</span>:
00285   PGSTD::string Reason() <span class="keyword">const</span>;
00286   PGconn *RawConnection() { <span class="keywordflow">return</span> largeobject::RawConnection(m_Trans); }
00287 
00288   <span class="keywordtype">void</span> open(openmode mode);
00289   <span class="keywordtype">void</span> close();
00290 
00291   dbtransaction &amp;m_Trans;
00292   <span class="keywordtype">int</span> m_fd;
00293 
00294   <span class="comment">// Not allowed:</span>
00295   largeobjectaccess();
00296   largeobjectaccess(<span class="keyword">const</span> largeobjectaccess &amp;);
00297   largeobjectaccess operator=(<span class="keyword">const</span> largeobjectaccess &amp;);
00298 };
00299 
<a name="l00301"></a><a class="code" href="namespacepqxx.html#a7">00301</a> <span class="keyword">typedef</span> largeobjectaccess <a class="code" href="classpqxx_1_1largeobjectaccess.html">LargeObjectAccess</a>;
00302 
00303 
00305 
00313 <span class="keyword">template</span>&lt;<span class="keyword">typename</span> CHAR=<span class="keywordtype">char</span>, <span class="keyword">typename</span> TRAITS=PGSTD::<span class="keywordtype">char</span>_traits&lt;CHAR&gt; &gt;
<a name="l00314"></a><a class="code" href="classpqxx_1_1largeobject__streambuf.html">00314</a>   <span class="keyword">class </span>PQXX_LIBEXPORT largeobject_streambuf :
00315 #ifdef <a class="code" href="config_8h.html#a12">HAVE_STREAMBUF</a>
00316     <span class="keyword">public</span> <a class="code" href="config_8h.html#a25">PGSTD</a>::basic_streambuf&lt;CHAR, TRAITS&gt;
00317 #else
00318     <span class="keyword">public</span> <a class="code" href="config_8h.html#a25">PGSTD</a>::streambuf
00319 #endif
00320 {
00321   <span class="keyword">typedef</span> <span class="keywordtype">long</span> size_type;
00322 <span class="keyword">public</span>:
<a name="l00323"></a><a class="code" href="classpqxx_1_1largeobject__streambuf.html#w0">00323</a>   <span class="keyword">typedef</span> CHAR   char_type;
<a name="l00324"></a><a class="code" href="classpqxx_1_1largeobject__streambuf.html#w1">00324</a>   <span class="keyword">typedef</span> TRAITS traits_type;
<a name="l00325"></a><a class="code" href="classpqxx_1_1largeobject__streambuf.html#w2">00325</a>   <span class="keyword">typedef</span> <span class="keyword">typename</span> traits_type::int_type int_type;
00326 <span class="preprocessor">#ifdef HAVE_STREAMBUF</span>
00327 <span class="preprocessor"></span>  <span class="keyword">typedef</span> <span class="keyword">typename</span> traits_type::pos_type pos_type;
00328   <span class="keyword">typedef</span> <span class="keyword">typename</span> traits_type::off_type off_type;
00329 <span class="preprocessor">#else</span>
<a name="l00330"></a><a class="code" href="classpqxx_1_1largeobject__streambuf.html#w3">00330</a> <span class="preprocessor"></span>  <span class="keyword">typedef</span> streamoff off_type;
<a name="l00331"></a><a class="code" href="classpqxx_1_1largeobject__streambuf.html#w4">00331</a>   <span class="keyword">typedef</span> streampos pos_type;
00332 <span class="preprocessor">#endif</span>
<a name="l00333"></a><a class="code" href="classpqxx_1_1largeobject__streambuf.html#w5">00333</a> <span class="preprocessor"></span>  <span class="keyword">typedef</span> largeobjectaccess::openmode openmode;
<a name="l00334"></a><a class="code" href="classpqxx_1_1largeobject__streambuf.html#w6">00334</a>   <span class="keyword">typedef</span> largeobjectaccess::seekdir seekdir;
00335 
<a name="l00336"></a><a class="code" href="classpqxx_1_1largeobject__streambuf.html#a0">00336</a>   largeobject_streambuf(<a class="code" href="classpqxx_1_1dbtransaction.html">dbtransaction</a> &amp;T,
00337                         largeobject O,
00338                         openmode mode = in | out,
00339                         size_type BufSize=512) :                        <span class="comment">//[t48]</span>
00340     m_BufSize(BufSize),
00341     m_Obj(T, O),
00342     m_G(0),
00343     m_P(0)
00344   {
00345     initialize(mode);
00346   }
00347 
<a name="l00348"></a><a class="code" href="classpqxx_1_1largeobject__streambuf.html#a1">00348</a>   largeobject_streambuf(<a class="code" href="classpqxx_1_1dbtransaction.html">dbtransaction</a> &amp;T,
00349                         oid O,
00350                         openmode mode = in | out,
00351                         size_type BufSize=512) :                        <span class="comment">//[t48]</span>
00352     m_BufSize(BufSize),
00353     m_Obj(T, O),
00354     m_G(0),
00355     m_P(0)
00356   {
00357     initialize(mode);
00358   }
00359 
<a name="l00360"></a><a class="code" href="classpqxx_1_1largeobject__streambuf.html#a2">00360</a>   <span class="keyword">virtual</span> ~largeobject_streambuf()
00361   {
00362     <span class="keyword">delete</span> [] m_P;
00363     <span class="keyword">delete</span> [] m_G;
00364   }
00365 
00366 
00367 <span class="preprocessor">#ifdef HAVE_STREAMBUF</span>
00368 <span class="preprocessor"></span><span class="keyword">protected</span>:
00369 <span class="preprocessor">#endif</span>
<a name="l00370"></a><a class="code" href="classpqxx_1_1largeobject__streambuf.html#a3">00370</a> <span class="preprocessor"></span>  <span class="keyword">virtual</span> <span class="keywordtype">int</span> sync()
00371   {
00372     <span class="comment">// setg() sets eback, gptr, egptr</span>
00373     setg(eback(), eback(), egptr());
00374     <span class="keywordflow">return</span> overflow(EoF());
00375   }
00376 
00377 <span class="keyword">protected</span>:
<a name="l00378"></a><a class="code" href="classpqxx_1_1largeobject__streambuf.html#b0">00378</a>   <span class="keyword">virtual</span> pos_type seekoff(off_type offset, 
00379                            seekdir dir,
00380                            openmode mode = in|out)
00381   {
00382     <span class="keywordflow">if</span> (!mode) {}       <span class="comment">// Quench "unused parameter" warning</span>
00383     <span class="keywordflow">return</span> AdjustEOF(m_Obj.cseek(offset, dir));
00384   }
00385 
<a name="l00386"></a><a class="code" href="classpqxx_1_1largeobject__streambuf.html#b1">00386</a>   <span class="keyword">virtual</span> pos_type seekpos(pos_type pos, 
00387                            openmode mode = in|out)
00388   {
00389     <span class="keywordflow">if</span> (!mode) {}       <span class="comment">// Quench "unused parameter" warning</span>
00390     <span class="keywordflow">return</span> AdjustEOF(m_Obj.cseek(pos, PGSTD::ios::beg));
00391   }
00392 
<a name="l00393"></a><a class="code" href="classpqxx_1_1largeobject__streambuf.html#b2">00393</a>   <span class="keyword">virtual</span> int_type overflow(int_type ch = EoF())
00394   {
00395     <span class="keywordtype">char</span> *<span class="keyword">const</span> pp = pptr();
00396     <span class="keywordflow">if</span> (!pp) <span class="keywordflow">return</span> EoF();
00397     <span class="keywordtype">char</span> *<span class="keyword">const</span> pb = pbase();
00398     int_type <a class="code" href="classpqxx_1_1result.html">result</a> = 0;
00399 
00400     <span class="keywordflow">if</span> (pp &gt; pb) result = AdjustEOF(m_Obj.cwrite(pb, pp-pb));
00401     setp(m_P, m_P + m_BufSize);
00402 
00403     <span class="comment">// Write that one more character, if it's there.</span>
00404     <span class="keywordflow">if</span> (ch != EoF())
00405     {
00406       *pptr() = char(ch);
00407       pbump(1);
00408     }
00409     <span class="keywordflow">return</span> result;
00410   }
00411 
<a name="l00412"></a><a class="code" href="classpqxx_1_1largeobject__streambuf.html#b3">00412</a>   <span class="keyword">virtual</span> int_type underflow()
00413   {
00414     <span class="keywordflow">if</span> (!gptr()) <span class="keywordflow">return</span> EoF();
00415     <span class="keywordtype">char</span> *<span class="keyword">const</span> eb = eback();
00416     <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classpqxx_1_1result.html">result</a> = AdjustEOF(m_Obj.cread(eback(), m_BufSize));
00417     setg(eb, eb, eb + ((result==EoF()) ? 0 : result));
00418     <span class="keywordflow">return</span> (!result || (result == EoF())) ? EoF() : *eb;
00419   }
00420 
00421 <span class="keyword">private</span>:
00423   <span class="keyword">static</span> int_type EoF() { <span class="keywordflow">return</span> traits_type::eof(); }
00424 
00426   <span class="keyword">static</span> PGSTD::streampos AdjustEOF(<span class="keywordtype">int</span> pos)
00427   {
00428     <span class="keywordflow">return</span> (pos == -1) ? EoF() : pos;
00429   }
00430 
00431   <span class="keywordtype">void</span> initialize(openmode mode)
00432   {
00433     <span class="keywordflow">if</span> (mode &amp; PGSTD::ios::in) 
00434     {
00435       m_G = <span class="keyword">new</span> char_type[m_BufSize];
00436       setg(m_G, m_G, m_G);
00437     }
00438     <span class="keywordflow">if</span> (mode &amp; PGSTD::ios::out)
00439     {
00440       m_P = <span class="keyword">new</span> char_type[m_BufSize];
00441       setp(m_P, m_P + m_BufSize);
00442     }
00443   }
00444 
00445   <span class="keyword">const</span> size_type m_BufSize;
00446   largeobjectaccess m_Obj;
00447 
00448   <span class="comment">// Get &amp; put buffers</span>
00449   char_type *m_G, *m_P;
00450 };
00451 
00452 
00454 
00462 <span class="keyword">template</span>&lt;<span class="keyword">typename</span> CHAR=<span class="keywordtype">char</span>, <span class="keyword">typename</span> TRAITS=PGSTD::<span class="keywordtype">char</span>_traits&lt;CHAR&gt; &gt; 
<a name="l00463"></a><a class="code" href="classpqxx_1_1basic__ilostream.html">00463</a>   <span class="keyword">class </span>PQXX_LIBEXPORT basic_ilostream :
00464 #ifdef <a class="code" href="config_8h.html#a12">HAVE_STREAMBUF</a>
00465     <span class="keyword">public</span> <a class="code" href="config_8h.html#a25">PGSTD</a>::basic_istream&lt;CHAR, TRAITS&gt;
00466 #else
00467     <span class="keyword">public</span> <a class="code" href="config_8h.html#a25">PGSTD</a>::istream
00468 #endif
00469 {
00470 <span class="preprocessor">#ifdef HAVE_STREAMBUF</span>
00471 <span class="preprocessor"></span>  <span class="keyword">typedef</span> PGSTD::basic_istream&lt;CHAR, TRAITS&gt; super;
00472 <span class="preprocessor">#else</span>
00473 <span class="preprocessor"></span>  <span class="keyword">typedef</span> PGSTD::istream super;
00474 <span class="preprocessor">#endif</span>
00475 <span class="preprocessor"></span>
00476 <span class="keyword">public</span>:
<a name="l00477"></a><a class="code" href="classpqxx_1_1basic__ilostream.html#w0">00477</a>   <span class="keyword">typedef</span> CHAR char_type;
<a name="l00478"></a><a class="code" href="classpqxx_1_1basic__ilostream.html#w1">00478</a>   <span class="keyword">typedef</span> TRAITS traits_type;
<a name="l00479"></a><a class="code" href="classpqxx_1_1basic__ilostream.html#w2">00479</a>   <span class="keyword">typedef</span> <span class="keyword">typename</span> traits_type::int_type int_type;
<a name="l00480"></a><a class="code" href="classpqxx_1_1basic__ilostream.html#w3">00480</a>   <span class="keyword">typedef</span> <span class="keyword">typename</span> traits_type::pos_type pos_type;
<a name="l00481"></a><a class="code" href="classpqxx_1_1basic__ilostream.html#w4">00481</a>   <span class="keyword">typedef</span> <span class="keyword">typename</span> traits_type::off_type off_type;
00482 
00484 
<a name="l00488"></a><a class="code" href="classpqxx_1_1basic__ilostream.html#a0">00488</a>   basic_ilostream(<a class="code" href="classpqxx_1_1dbtransaction.html">dbtransaction</a> &amp;T, 
00489                   largeobject O, 
00490                   largeobject::size_type BufSize=512) :                 <span class="comment">//[]</span>
00491     super(m_Buf),
00492     m_Buf(T, O, in, BufSize) 
00493   { 
00494   }
00495 
00497 
<a name="l00501"></a><a class="code" href="classpqxx_1_1basic__ilostream.html#a1">00501</a>   basic_ilostream(<a class="code" href="classpqxx_1_1dbtransaction.html">dbtransaction</a> &amp;T, 
00502                   oid O, 
00503                   largeobject::size_type BufSize=512) :                 <span class="comment">//[t48]</span>
00504     super(&amp;m_Buf),
00505     m_Buf(T, O, in, BufSize) 
00506   { 
00507   }
00508 
00509 <span class="keyword">private</span>:
00510   largeobject_streambuf&lt;CHAR,TRAITS&gt; m_Buf;
00511 };
00512 
<a name="l00513"></a><a class="code" href="namespacepqxx.html#a8">00513</a> <span class="keyword">typedef</span> <a class="code" href="classpqxx_1_1basic__ilostream.html">basic_ilostream&lt;char&gt;</a> <a class="code" href="namespacepqxx.html#a8">ilostream</a>;
00514 
00515 
00517 
00525 <span class="keyword">template</span>&lt;<span class="keyword">typename</span> CHAR=<span class="keywordtype">char</span>, <span class="keyword">typename</span> TRAITS=PGSTD::<span class="keywordtype">char</span>_traits&lt;CHAR&gt; &gt; 
<a name="l00526"></a><a class="code" href="classpqxx_1_1basic__olostream.html">00526</a>   <span class="keyword">class </span>PQXX_LIBEXPORT basic_olostream : 
00527 #ifdef <a class="code" href="config_8h.html#a12">HAVE_STREAMBUF</a>
00528     <span class="keyword">public</span> <a class="code" href="config_8h.html#a25">PGSTD</a>::basic_ostream&lt;CHAR, TRAITS&gt;
00529 #else
00530     <span class="keyword">public</span> <a class="code" href="config_8h.html#a25">PGSTD</a>::ostream
00531 #endif
00532 {
00533 <span class="preprocessor">#ifdef HAVE_STREAMBUF</span>
00534 <span class="preprocessor"></span>  <span class="keyword">typedef</span> PGSTD::basic_ostream&lt;CHAR, TRAITS&gt; super;
00535 <span class="preprocessor">#else</span>
00536 <span class="preprocessor"></span>  <span class="keyword">typedef</span> PGSTD::ostream super;
00537 <span class="preprocessor">#endif</span>
00538 <span class="preprocessor"></span><span class="keyword">public</span>:
<a name="l00539"></a><a class="code" href="classpqxx_1_1basic__olostream.html#w0">00539</a>   <span class="keyword">typedef</span> CHAR char_type;
<a name="l00540"></a><a class="code" href="classpqxx_1_1basic__olostream.html#w1">00540</a>   <span class="keyword">typedef</span> TRAITS traits_type;
<a name="l00541"></a><a class="code" href="classpqxx_1_1basic__olostream.html#w2">00541</a>   <span class="keyword">typedef</span> <span class="keyword">typename</span> traits_type::int_type int_type;
<a name="l00542"></a><a class="code" href="classpqxx_1_1basic__olostream.html#w3">00542</a>   <span class="keyword">typedef</span> <span class="keyword">typename</span> traits_type::pos_type pos_type;
<a name="l00543"></a><a class="code" href="classpqxx_1_1basic__olostream.html#w4">00543</a>   <span class="keyword">typedef</span> <span class="keyword">typename</span> traits_type::off_type off_type;
00544 
00546 
<a name="l00550"></a><a class="code" href="classpqxx_1_1basic__olostream.html#a0">00550</a>   basic_olostream(<a class="code" href="classpqxx_1_1dbtransaction.html">dbtransaction</a> &amp;T, 
00551                   largeobject O,
00552                   largeobject::size_type BufSize=512) :                 <span class="comment">//[t48]</span>
00553     super(&amp;m_Buf),
00554     m_Buf(T, O, out, BufSize) 
00555   { 
00556   }
00557 
00559 
<a name="l00563"></a><a class="code" href="classpqxx_1_1basic__olostream.html#a1">00563</a>   basic_olostream(<a class="code" href="classpqxx_1_1dbtransaction.html">dbtransaction</a> &amp;T, 
00564                   oid O,
00565                   largeobject::size_type BufSize=512) :                 <span class="comment">//[]</span>
00566     super(&amp;m_Buf),
00567     m_Buf(T, O, out, BufSize) 
00568   { 
00569   }
00570 
<a name="l00571"></a><a class="code" href="classpqxx_1_1basic__olostream.html#a2">00571</a>   ~basic_olostream() 
00572   { 
00573 <span class="preprocessor">#ifdef HAVE_STREAMBUF</span>
00574 <span class="preprocessor"></span>    m_Buf.pubsync(); m_Buf.pubsync(); 
00575 <span class="preprocessor">#else</span>
00576 <span class="preprocessor"></span>    m_Buf.sync(); m_Buf.sync();
00577 <span class="preprocessor">#endif</span>
00578 <span class="preprocessor"></span>  }
00579 
00580 <span class="keyword">private</span>:
00581   largeobject_streambuf&lt;CHAR,TRAITS&gt; m_Buf;
00582 };
00583 
<a name="l00584"></a><a class="code" href="namespacepqxx.html#a9">00584</a> <span class="keyword">typedef</span> <a class="code" href="classpqxx_1_1basic__olostream.html">basic_olostream&lt;char&gt;</a> <a class="code" href="namespacepqxx.html#a9">olostream</a>;
00585 
00586 
00588 
00596 <span class="keyword">template</span>&lt;<span class="keyword">typename</span> CHAR=<span class="keywordtype">char</span>, <span class="keyword">typename</span> TRAITS=PGSTD::<span class="keywordtype">char</span>_traits&lt;CHAR&gt; &gt; 
<a name="l00597"></a><a class="code" href="classpqxx_1_1basic__lostream.html">00597</a>   <span class="keyword">class </span>PQXX_LIBEXPORT basic_lostream :
00598 #ifdef <a class="code" href="config_8h.html#a12">HAVE_STREAMBUF</a>
00599     <span class="keyword">public</span> <a class="code" href="config_8h.html#a25">PGSTD</a>::basic_iostream&lt;CHAR, TRAITS&gt;
00600 #else
00601     <span class="keyword">public</span> <a class="code" href="config_8h.html#a25">PGSTD</a>::iostream
00602 #endif
00603 {
00604 <span class="preprocessor">#ifdef HAVE_STREAMBUF</span>
00605 <span class="preprocessor"></span>  <span class="keyword">typedef</span> PGSTD::basic_iostream&lt;CHAR, TRAITS&gt; super;
00606 <span class="preprocessor">#else</span>
00607 <span class="preprocessor"></span>  <span class="keyword">typedef</span> PGSTD::iostream super;
00608 <span class="preprocessor">#endif</span>
00609 <span class="preprocessor"></span>
00610 <span class="keyword">public</span>:
<a name="l00611"></a><a class="code" href="classpqxx_1_1basic__lostream.html#w0">00611</a>   <span class="keyword">typedef</span> CHAR char_type;
<a name="l00612"></a><a class="code" href="classpqxx_1_1basic__lostream.html#w1">00612</a>   <span class="keyword">typedef</span> TRAITS traits_type;
<a name="l00613"></a><a class="code" href="classpqxx_1_1basic__lostream.html#w2">00613</a>   <span class="keyword">typedef</span> <span class="keyword">typename</span> traits_type::int_type int_type;
<a name="l00614"></a><a class="code" href="classpqxx_1_1basic__lostream.html#w3">00614</a>   <span class="keyword">typedef</span> <span class="keyword">typename</span> traits_type::pos_type pos_type;
<a name="l00615"></a><a class="code" href="classpqxx_1_1basic__lostream.html#w4">00615</a>   <span class="keyword">typedef</span> <span class="keyword">typename</span> traits_type::off_type off_type;
00616 
00618 
<a name="l00622"></a><a class="code" href="classpqxx_1_1basic__lostream.html#a0">00622</a>   basic_lostream(<a class="code" href="classpqxx_1_1dbtransaction.html">dbtransaction</a> &amp;T, 
00623                  largeobject O,
00624                  largeobject::size_type BufSize=512) :                  <span class="comment">//[]</span>
00625     super(&amp;m_Buf),
00626     m_Buf(T, O, in | out, BufSize) 
00627   { 
00628   }
00629 
00631 
<a name="l00635"></a><a class="code" href="classpqxx_1_1basic__lostream.html#a1">00635</a>   basic_lostream(<a class="code" href="classpqxx_1_1dbtransaction.html">dbtransaction</a> &amp;T, 
00636                  oid O,
00637                  largeobject::size_type BufSize=512) :                  <span class="comment">//[]</span>
00638     super(&amp;m_Buf),
00639     m_Buf(T, O, in | out, BufSize) 
00640   { 
00641   }
00642 
<a name="l00643"></a><a class="code" href="classpqxx_1_1basic__lostream.html#a2">00643</a>   ~basic_lostream() 
00644   { 
00645 <span class="preprocessor">#ifdef HAVE_STREAMBUF</span>
00646 <span class="preprocessor"></span>    m_Buf.pubsync(); m_Buf.pubsync(); 
00647 <span class="preprocessor">#else</span>
00648 <span class="preprocessor"></span>    m_Buf.sync(); m_Buf.sync();
00649 <span class="preprocessor">#endif</span>
00650 <span class="preprocessor"></span>  }
00651 
00652 <span class="keyword">private</span>:
00653   largeobject_streambuf&lt;CHAR,TRAITS&gt; m_Buf;
00654 };
00655 
<a name="l00656"></a><a class="code" href="namespacepqxx.html#a10">00656</a> <span class="keyword">typedef</span> <a class="code" href="classpqxx_1_1basic__lostream.html">basic_lostream&lt;char&gt;</a> <a class="code" href="namespacepqxx.html#a10">lostream</a>;
00657 
00658 }
00659 
00660 <span class="preprocessor">#endif</span>
00661 <span class="preprocessor"></span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Sat Jun 14 00:10:13 2003 for libpqxx by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.1 </small></address>
</body>
</html>
