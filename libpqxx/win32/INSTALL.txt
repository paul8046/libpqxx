
Welcome to libpqxx, a C++ API to the PostgreSQL database management system.
Please see the regular README for general instructions on building, installing,
and using the library.  If you are using Cygwin or another Unix-like environment
please try the Unix configuration & build procedure instead of the one described
here.  Things are a bit more complicated for Windows systems.

To get started quickly on a Windows system, use the command line.
1) If you're using Visual C++, run VCVARS32.BAT to prepare the environment.
2) Edit win32/common to reflect the correct paths to your PostgreSQL includes
   and library files.
3) Create the configuration headers include/pqxx/config-*-*.h.  These are
   normally generated by the configure script, but this file documents the
   procedure for systems unable to run this script.  How these files work is
   described below.
4) Modify the "common" makefile to suit your environment.  See "Changing the
   makefile" below.
5) Now "nmake /f libpqxx.mak ALL" will compile all dynamic, static, debug and 
   release libraries. You will find them in the win32\lib directory.
   
After that, it is recommended that you compile and run the self-test programs
included in the package:
6) "nmake /f test.mak ALL" will compile and link all the test files. It is
   currently set to use the dll version of libpqxx.
7) Make sure a PostgreSQL database is running and accessible; set up the
   environment as described in README so that the test programs can access the
   database without passing a connection string.
8) Run each of the test programs in order.  Some of them will generate lots of
   output, some won't produce any.  Error messages that are expected in the
   course of a normal test run are prefixed with "(Expected)" to show that they
   are not harmful.  All tests should complete successfully.
 

Setting up the configuration headers

Several headers, normally generated by the configure script, define certain
aspects of your compilation environment so that the library can work around
typical compiler shortcomings, functions missing in older libpq versions, etc.

Each of these items is a preprocessor macro that is either #define'd to some
value or not defined at all.  Most of the items are of a Boolean nature, i.e.
some feature or workaround is enabled if the corresponding macro is defined
(regardless of value; 0 will work as well as 1, but a value of 1 is the
convention) or disabled if the macro is left undefined.  Some few items require
a meaningful value, e.g. PGSTD needs to be defined to the name of the standard
namespace (typically std).

At the time of writing, there are 5 of these configuration headers, all located
in the include/pqxx subdirectory:

	config-internal-autotools.h
	config-internal-compiler.h
	config-internal-libpq.h
	config-public-compiler.h
	config-public-libpq.h

The first one, config-internal-autotools.h, contains only some utility
definitions normally generated by the configuration infrastructure--you're not
likely to need them, so this file can even be left blank.

The names contain two variables:

1. Internal or public.  Configuration items that affect the compilation of
your client program are located in the config-public-*.h files; ones that affect
only the compilation of the library itself are kept in the config-internal-*.h
ones (and are not included at all when compiling client programs).  Public
configuration items (except PGSTD) are prefixed with PQXX_ to avoid clashes with
macros defined by other code.

2. Autotools-related, compiler-related, or libpq-related.  Again, the autotools
items are of no real interest, but the compiler and libpq ones are different.
The compiler-related ones describe features and shortcomings of the compiler
environment, such as the availability of the <unistd.h> header or the ability
to compile certain complex C++ language constructs.  The libpq items describe
what features are available in the version of libpq you're compiling against.
At the time of writing, the latter all take the HAVE_... form; defining such a
macro indicates that the corresponding feature is available.

A complete list of configuration items and their categorizations can be found in
the configitems file.  The normal configure script reads the list of items from
include/pqxx/config.h.in and writes them to include/pqxx/config.h, then splits
them up into the five smaller files as directed by the configitems database.

Before you try setting up these files with #define directives, see if you can
find ready-made configuration headers for your compiler environment and/or libpq
version.  Take the config-*-compiler.h headers from someone who used the same
compiler (preferably more or less the same compiler and libpqxx versions) as
you, regardless of libpq version.

Similarly, use config-*-libpq.h files created for a libpq version similar to
yours, regardless of system platform or compiler environment.  This may well be
a version generated automatically using the configure script on another system.


Changing the makefile

There are 2 items in the makefile that may need to be changed, all have at
least a little bit of documentation.  All these changes take place in the
file "common" so you shouldn't get any oddities when compiling the test
cases due to a mismatch in compiler settings.

PGSQLSRC
You will need to change this option.  While we don't actually use the source
files from postgres, some of the header files are necessary.  Set this option
where the src directory of postgres is located.  It can handle it from there.

LIBPATH
This is where the release version of libpq is located.  Refer to the postgres
documentation on building this file if you don't have one.


Troubleshooting

The biggest typical problem for Windows/VC++ users is the need to edit the
configuration headers manually, resulting usually in compile errors, e.g. for
missing header files.  Thus, if you get a compile error, the first places to
look are the config-*-*.h and config-*-*.h files located in include/pqxx.

If, for instance, the error states that the header file <sys/select.h> is
missing, you will find a configuration variable called PQXX_HAVE_SYS_SELECT_H,
which should not be set if your system doesn't have sys/select.h.  Remove the
#define directive naming this variable from the configuration header where it is
defined (see the configitems file for a list of locations) and the error should
disappear on the next attempt.

To generate the config-*-libpq.h files, a good starting point is to #define all
libpq-related configuration items (see configitems!) and make sure you use a
fairly recent libpq version.  If you get errors about missing functions in this
library, look up the configuration item in the config-*-libpq.h files and
comment out the corresponding #define directive.

If you have to edit your configuration headers, please send your results to the
author or to the libpqxx-general mailing list so that headers corresponding to
your environment can be included in later libpqxx releases.

CAUTION: DO NOT try to unset yes/no configuration items by defining their macros
to zero.  A value of zero is counted as "yes."  If it's defined, it means "yes"
regardless of what actual value you set.

